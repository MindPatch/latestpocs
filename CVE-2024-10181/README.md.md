
### Description 
CVE-2024-10181 is a stored cross-site scripting (XSS) vulnerability identified in the Newsletters plugin for WordPress. This vulnerability allows **authenticated** users with contributor-level access or higher to inject arbitrary web scripts via the `newsletters_video` shortcode. The malicious scripts execute whenever a user accesses the affected page.


### Steps to reproduce
1. Login to your wordpress account
2. Visit this endpoint `/wp-admin/admin.php?page=newsletters-create`
3. in Content area add this payload
```
[newsletters_video url="google.com" width='100" --!><img src=x onerror=alert()> "' height="100"]
```
Click on Update Preview:)

![[img/Screenshot from 2024-11-03 20-27-08.png]]
### Backstory (how it's working)

The developer attempts to prevent XSS by clearing any attribute values that don’t fall within double or single quotes. This restriction makes it seem impossible to escape and inject additional attributes. However, if a single quote is added, the XSS check's conditional statement passes, allowing the payload to bypass the filter. Since browsers can escape single quotes with double quotes, this creates an opening—the content within the quotes isn't escaped, allowing our payload to work
